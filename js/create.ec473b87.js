"use strict";(self["webpackChunkgovernance_aepp"]=self["webpackChunkgovernance_aepp"]||[]).push([[886],{80054:function(t,e,i){i.d(e,{Z:function(){return p}});var r=i(66252),n=i(3577);const o={class:"ae-input-box"},a={key:0,class:"ae-input-header"},s=["for"],l=["id","value"];function c(t,e,i,c,u,d){return(0,r.wg)(),(0,r.iD)("div",{class:(0,n.C_)(["ae-input-container",{focus:u.focus,error:i.error}])},[(0,r._)("div",o,[i.label?((0,r.wg)(),(0,r.iD)("div",a,[(0,r._)("label",{for:i.id,class:"ae-input-label"},(0,n.zw)(i.label),9,s),(0,r.WI)(t.$slots,"header",{},void 0,!0)])):(0,r.kq)("",!0),t.$slots.default?(0,r.WI)(t.$slots,"default",{key:2,context:this},void 0,!0):((0,r.wg)(),(0,r.iD)("input",(0,r.dG)({key:1,class:["ae-input",{aemount:i.aemount}],id:i.id,value:i.modelValue,onFocus:e[0]||(e[0]=t=>u.focus=!0),onBlur:e[1]||(e[1]=t=>{d.propagateEvent(t),u.focus=!1}),onInput:e[2]||(e[2]=(...t)=>d.propagateEventValue&&d.propagateEventValue(...t))},t.$attrs),null,16,l))]),(0,r.WI)(t.$slots,"footer",{},void 0,!0)],2)}var u={name:"ae-input",data(){return{focus:!1}},emits:["update:modelValue","blur"],props:{id:String,modelValue:[String,Number],label:String,aemount:Boolean,aeddress:Boolean,error:Boolean},methods:{propagateEvent(t){this.$emit(t.type,t)},propagateEventValue(t){this.$emit("update:modelValue",t.target.value)}}},d=i(83744);const h=(0,d.Z)(u,[["render",c],["__scopeId","data-v-fa932c3c"]]);var p=h},86158:function(t,e,i){i.d(e,{Z:function(){return p}});var r=i(66252),n=i(49963),o=i.p+"img/hash_white.8c0a10d1.svg";const a={class:"bg-gray-ae px-6 py-4 w-full text-3xl text-white flex justify-between items-center"},s={class:"flex items-center justify-end"},l={key:0,ref:"inputContainer",class:"relative rounded-full hide-input flex items-center pr-3 pb-1"};function c(t,e,i,c,u,d){return(0,r.wg)(),(0,r.iD)("div",a,[(0,r.WI)(t.$slots,"default",{},void 0,!0),(0,r._)("div",s,[i.showNumberInput?((0,r.wg)(),(0,r.iD)("div",l,[(0,r._)("img",{src:o,class:"h-6 pl-4 pt-1 cursor-pointer",onClick:e[0]||(e[0]=(...t)=>d.showInput&&d.showInput(...t)),alt:"enter id"}),(0,r._)("form",{onSubmit:e[4]||(e[4]=(0,n.iM)(((...t)=>d.submit&&d.submit(...t)),["prevent"]))},[(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>u.id=t),ref:"input",type:"number",onInput:e[2]||(e[2]=e=>t.$emit("input",u.id)),class:"text-gray-800 w-full text-2xl outline-none bg-transparent leading-none",onBlur:e[3]||(e[3]=(...t)=>d.onBlur&&d.onBlur(...t))},null,544),[[n.nr,u.id]])],32)],512)):(0,r.kq)("",!0),(0,r._)("div",{class:"w-8 text-2xl h-8 bg-primary rounded-full justify-center flex items-center ml-2 cursor-pointer",onClick:e[5]||(e[5]=(0,n.iM)((t=>d.toggleHelp()),["stop","prevent"])),id:"question-mark-icon"}," ? ")])])}i(57658);var u={name:"BlackHeader",data(){return{extended:!1,id:null,activeTimeout:0}},props:{showNumberInput:{type:Boolean,default:!1}},methods:{submit(){this.$refs.input.blur(),this.$emit("submit",this.id)},onBlur(){this.$refs.inputContainer.classList.add("hide-input-animation"),this.activeTimeout=setTimeout((()=>{this.$refs.inputContainer.classList.remove("show-input","hide-input-animation"),this.extended=!1,this.id=null}),600)},showInput(){this.extended||(this.extended=!0,this.$refs.inputContainer.classList.add("show-input-animation"),this.activeTimeout=setTimeout((()=>{this.$refs.inputContainer.classList.add("show-input"),this.$refs.inputContainer.classList.remove("show-input-animation")}),600),this.$refs.input.focus())},toggleHelp(){"help"!==this.$route.name?this.$router.push("help"):this.$router.go(-1)}},beforeUnmount(){this.activeTimeout&&clearTimeout(this.activeTimeout)}},d=i(83744);const h=(0,d.Z)(u,[["render",c],["__scopeId","data-v-341082cb"]]);var p=h},94848:function(t,e,i){i.d(e,{Z:function(){return D}});i(57658);var r=i(66252),n=i(3577),o=i(49963);const a={class:"flex justify-center w-full z-20"},s={key:0,class:"w-full flex h-12 mb-6 px-8 items-center"},l={class:"w-full h-full"},c=["id"],u={class:"flex justify-evenly items-center h-full flex-2"},d={class:"flex-3 flex justify-center"},h=["disabled"],p={class:"flex justify-evenly items-center h-full flex-2"};function g(t,e,i,g,m,f){const v=(0,r.up)("SmallButton");return(0,r.wg)(),(0,r.iD)("div",a,[(0,r._)("div",{class:(0,n.C_)(["fixed bottom-0 h-12 pb-8 w-full max-w-desktop bottom-bar",{"h-32":"search"===m.view}])},["search"===m.view?((0,r.wg)(),(0,r.iD)("div",s,[(0,r._)("label",l,[(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>m.searchString=t),type:"search",placeholder:"Search...",class:"rounded-full flex-1 bg-white h-full flex justify-center items-center px-4 w-full search-bar"},null,512),[[o.nr,m.searchString]])]),i.searchButton?((0,r.wg)(),(0,r.j4)(v,{key:0,img:m.images.searchImg,class:"ml-2",onClick:e[1]||(e[1]=e=>t.$emit("searchSubmit",m.searchString))},null,8,["img"])):(0,r.kq)("",!0)])):(0,r.kq)("",!0),(0,r._)("div",{class:"w-full flex h-12",id:i.htmlId},[(0,r._)("div",u,[(0,r.Wm)(v,{img:m.images.homeImg,onClick:e[2]||(e[2]=()=>"/"!==t.$route.path&&t.$router.push("/"))},null,8,["img"]),t.wallet.address?((0,r.wg)(),(0,r.j4)(v,{key:0,img:m.images.accountImg,onClick:e[3]||(e[3]=()=>t.$route.path!==`/account/${t.wallet.address}`&&t.$router.push(`/account/${t.wallet.address}`))},null,8,["img"])):(0,r.kq)("",!0)]),(0,r._)("div",d,[i.ctaText?((0,r.wg)(),(0,r.iD)("button",{key:0,class:"rounded-full bg-primary px-8 h-full flex justify-center items-center text-white font-semibold cursor-pointer",onClick:e[4]||(e[4]=e=>t.$emit("cta")),disabled:i.ctaDisabled},(0,n.zw)(i.ctaText),9,h)):(0,r.kq)("",!0),i.searchBar?((0,r.wg)(),(0,r.iD)("div",{key:1,class:(0,n.C_)(["rounded-full bg-primary px-8 h-full flex justify-center items-center text-white font-semibold relative cursor-pointer",{"search-button":"search"===m.view}]),onClick:e[5]||(e[5]=(...t)=>f.clickSearch&&f.clickSearch(...t))}," Search ",2)):(0,r.kq)("",!0)]),(0,r._)("div",p,[t.wallet.address?((0,r.wg)(),(0,r.j4)(v,{key:0,img:m.images.createImg,onClick:e[6]||(e[6]=()=>"/create"!==t.$route.path&&t.$router.push("/create"))},null,8,["img"])):(0,r.kq)("",!0),(0,r.Wm)(v,{img:m.images.backImg,onClick:e[7]||(e[7]=()=>t.$router.go(-1))},null,8,["img"])])],8,c)],2)])}const m={class:"w-8 h-8"},f=["src"];function v(t,e,i,n,o,a){return(0,r.wg)(),(0,r.iD)("div",m,[(0,r._)("div",{class:"rounded-full w-full h-full flex justify-center items-center shadow bg-gray-ae cursor-pointer",onClick:e[0]||(e[0]=e=>t.$emit("click"))},[(0,r._)("img",{src:i.img,alt:"generic_alt",class:"w-8 h-8"},null,8,f)])])}var w={name:"SmallButton",props:["img"]},y=i(83744);const _=(0,y.Z)(w,[["render",v],["__scopeId","data-v-7346b345"]]);var b=_,I=i.p+"img/search.35d19cd2.svg",k=i.p+"img/create.a2bcfc82.svg",x=i.p+"img/account.f81d2d23.svg",E=i.p+"img/home.3a882090.svg",S=i.p+"img/back.ef486cb4.svg",T=i(81251),C={name:"BottomButtons",components:{SmallButton:b},data(){return{view:"buttons",images:{searchImg:I,createImg:k,accountImg:x,homeImg:E,backImg:S},searchString:""}},setup:()=>({wallet:T.gU}),props:{home:{type:Boolean,default:!0},searchBar:{type:Boolean,default:!1},addPoll:{type:Boolean,default:!1},back:{type:String,default:null},ctaText:{type:String,default:null},ctaAction:{type:Function,default:()=>{}},ctaDisabled:{type:Boolean,default:!1},searchButton:{type:Boolean,default:!1},htmlId:{type:String}},watch:{searchString(){this.$emit("search",this.searchString)}},methods:{clickSearch(){"buttons"===this.view?this.view="search":"search"===this.view&&(this.view="buttons")}}};const H=(0,y.Z)(C,[["render",g],["__scopeId","data-v-60b2c752"]]);var D=H},11758:function(t,e,i){i.d(e,{Z:function(){return c}});var r=i(66252);const n={class:"mx-4 mb-4 mt-2 p-4 bg-gray-200 text-gray-600 text-sm ae-triangle-after"};function o(t,e,i,o,a,s){return(0,r.wg)(),(0,r.iD)("div",n,[(0,r.WI)(t.$slots,"default",{},void 0,!0)])}var a={name:"HintBubble"},s=i(83744);const l=(0,s.Z)(a,[["render",o],["__scopeId","data-v-7ca5dc6e"]]);var c=l},2894:function(t,e,i){i.r(e),i.d(e,{default:function(){return X}});var r=i(66252),n=i(49963),o=i(3577);const a=t=>((0,r.dD)("data-v-2b2e2128"),t=t(),(0,r.Cn)(),t),s={class:"overlay-loader"},l={key:0,class:"bg-ae-error mx-4 p-2 my-2"},c=a((()=>(0,r._)("div",{class:"flex mb-1"},[(0,r._)("div",{class:"text-4xl font-bold pl-1 pr-3 leading-none flex items-center"}," ! "),(0,r._)("div",null,[(0,r._)("span",{class:"font-bold"},"Hey there is a problem!"),(0,r.Uk)(" Check the red fields below and try again. ")])],-1))),u={class:"block ml-6 pl-1"},d={class:"py-2 px-4"},h={class:"py-2 px-4"},p={class:"mt-2"},g=a((()=>(0,r._)("a",{href:"https://forum.aeternity.com",target:"_blank"},"https://forum.aeternity.com",-1))),m={class:"pb-2 px-4"},f={class:"py-2 px-4"},v={class:"w-6 flex justify-center"},w={key:0,class:"rounded-full border-2 border-gray-500 w-6 h-6"},y={key:1,class:"text-3xl text-gray-300 text-right font-bold"},_=["onUpdate:modelValue"],b={key:0},I=["onClick"],k={class:"py-2 px-4 mb-16"},x={class:"mt-4 flex"},E={class:"text-gray-500 text-sm p-2"},S={key:0},T={key:1},C={key:2};function H(t,e,i,a,H,D){const O=(0,r.up)("BiggerLoader"),N=(0,r.up)("BlackHeader"),A=(0,r.up)("GrayText"),B=(0,r.up)("ae-input"),$=(0,r.up)("HintBubble"),R=(0,r.up)("ae-button"),L=(0,r.up)("AeButtonGroup"),U=(0,r.up)("BottomButtons"),M=(0,r.up)("CriticalErrorOverlay");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.wy)((0,r._)("div",s,[(0,r.Wm)(O)],512),[[n.F8,H.showLoading]]),(0,r.Wm)(N,null,{default:(0,r.w5)((()=>[(0,r.Uk)(" Create Poll ")])),_:1}),(0,r.Wm)(A,null,{default:(0,r.w5)((()=>[(0,r.Uk)(" Use the form below to create a new governance poll. ")])),_:1}),Object.values(this.errors).some((t=>!!t))?((0,r.wg)(),(0,r.iD)("div",l,[c,(0,r._)("ul",u,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(Object.values(this.errors).filter((t=>t)),(t=>((0,r.wg)(),(0,r.iD)("li",{key:t,class:"list-disc"},(0,o.zw)(t),1)))),128))])])):(0,r.kq)("",!0),(0,r._)("div",d,[(0,r.Wm)(B,{error:!!H.errors.titleError,modelValue:H.createMetadata.title,"onUpdate:modelValue":e[0]||(e[0]=t=>H.createMetadata.title=t),label:"Title"},null,8,["error","modelValue"])]),(0,r._)("div",h,[(0,r.Wm)(B,{error:!!H.errors.descriptionError,modelValue:H.createMetadata.description,"onUpdate:modelValue":e[1]||(e[1]=t=>H.createMetadata.description=t),label:"Description"},null,8,["error","modelValue"])]),(0,r._)("div",p,[H.showForumHint?((0,r.wg)(),(0,r.j4)($,{key:0},{default:(0,r.w5)((()=>[(0,r.Uk)(" For easier discussions on your proposal we suggest you create a thread in the æternity forum and link it here. ("),g,(0,r.Uk)(") ")])),_:1})):(0,r.kq)("",!0)]),(0,r._)("div",m,[(0,r.Wm)(B,{error:!!H.errors.linkError,modelValue:H.createMetadata.link,"onUpdate:modelValue":e[2]||(e[2]=t=>H.createMetadata.link=t),label:"Link",onBlur:D.linkBlurHandler},null,8,["error","modelValue","onBlur"])]),(0,r._)("div",f,[(0,r.Wm)(L,null,{default:(0,r.w5)((()=>[(0,r.Wm)(R,{face:"round",onClick:e[3]||(e[3]=t=>H.is_listed=!0),fill:H.is_listed?"primary":"neutral"},{default:(0,r.w5)((()=>[(0,r.Uk)("Publicly Listed ")])),_:1},8,["fill"]),(0,r.Wm)(R,{face:"round",onClick:e[4]||(e[4]=t=>H.is_listed=!1),fill:H.is_listed?"neutral":"primary"},{default:(0,r.w5)((()=>[(0,r.Uk)("Not Listed ")])),_:1},8,["fill"])])),_:1})]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(H.options,(t=>((0,r.wg)(),(0,r.iD)("div",{class:(0,o.C_)(["my-2 mx-4 flex items-center bg-white px-4",{"bg-ae-error":!!H.errors.optionError}]),key:t.id},[(0,r._)("div",v,[t.text?((0,r.wg)(),(0,r.iD)("div",w," ")):((0,r.wg)(),(0,r.iD)("div",y,"+"))]),(0,r._)("label",null,[(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":e=>t.text=e,onInput:e[5]||(e[5]=(...t)=>D.optionInput&&D.optionInput(...t)),type:"text",placeholder:"Add Option",class:(0,o.C_)(["ae-input-option w-full h-full px-2 py-6 outline-none",{"bg-ae-error":!!H.errors.optionError}])},null,42,_),[[n.nr,t.text]])]),t.text?((0,r.wg)(),(0,r.iD)("div",b,[(0,r._)("div",{class:"text-2xl text-gray-500 text-right",onClick:e=>D.removeOption(t.id)},"×",8,I)])):(0,r.kq)("",!0)],2)))),128)),(0,r._)("div",k,[(0,r.Wm)(B,{error:!!H.errors.closeHeightError,type:"number",modelValue:H.closeHeight,"onUpdate:modelValue":e[6]||(e[6]=t=>H.closeHeight=t),onInput:D.updateDateInputs,label:"Close at height"},null,8,["error","modelValue","onInput"]),(0,r._)("div",x,[(0,r.Wm)(B,{type:"date",class:"mr-2",label:"Est. close date",modelValue:H.dateString,"onUpdate:modelValue":e[7]||(e[7]=t=>H.dateString=t),onInput:D.updateCloseHeight},null,8,["modelValue","onInput"]),(0,r.Wm)(B,{type:"time",label:"Est. close time",modelValue:H.timeString,"onUpdate:modelValue":e[8]||(e[8]=t=>H.timeString=t),onInput:D.updateCloseHeight},null,8,["modelValue","onInput"])]),(0,r._)("div",E,[H.closeHeight&&H.closeHeight>H.height?((0,r.wg)(),(0,r.iD)("span",S," To create a never closing poll, set close height to 0. ")):(0,r.kq)("",!0),H.closeHeight&&H.closeHeight<H.height&&"0"!==H.closeHeight?((0,r.wg)(),(0,r.iD)("span",T," Current height is "+(0,o.zw)(H.height)+" and closing height "+(0,o.zw)(H.closeHeight)+" lies in the past. ",1)):(0,r.kq)("",!0),"0"===H.closeHeight?((0,r.wg)(),(0,r.iD)("span",C," This poll will never close. ")):(0,r.kq)("",!0)])]),(0,r.Wm)(U,{"cta-text":"Create Poll",onCta:D.createPoll},null,8,["onCta"]),(0,r.Wm)(M,{error:H.criticalError,onContinue:e[9]||(e[9]=t=>H.criticalError=null)},null,8,["error"])])}i(57658);var D='// ISC License\n//\n// Copyright (c) 2019, aeternity developers\n//\n// Permission to use, copy, modify, and/or distribute this software for any\n// purpose with or without fee is hereby granted, provided that the above\n// copyright notice and this permission notice appear in all copies.\n//\n// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n// REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n// AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n// INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n// LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n// OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n// PERFORMANCE OF THIS SOFTWARE.\n\n\n// THIS IS NOT SECURITY AUDITED\n// DO NEVER USE THIS WITHOUT SECURITY AUDIT FIRST\n\n@compiler >= 5\n\ninclude "String.aes"\n\ncontract Poll =\n\n  record metadata =\n    { title : string\n    , description : string\n    , link : string\n    , spec_ref : option(hash)}\n\n  type vote_option = map(int, string)\n\n  type votes = map(address, int)\n\n  record state =\n    { metadata : metadata\n    , vote_options : vote_option\n    , close_height : option(int)\n    , create_height : int\n    , votes : votes\n    , author : address }\n\n  datatype event =\n      Vote(address, address, int)\n    | RevokeVote(address, address)\n\n  entrypoint init(metadata : metadata, vote_options : vote_option, close_height : option(int)) : state =\n    require(String.length(metadata.title) =< 50, "TITLE_STRING_TO_LONG")\n    require(String.length(metadata.description) =< 300, "DESCRIPTION_STRING_TO_LONG")\n    { metadata = metadata,\n      vote_options = vote_options,\n      close_height = close_height,\n      create_height = Chain.block_height,\n      votes = {},\n      author = Call.caller }\n\n  // STATEFULL FUNCTIONS\n\n  stateful entrypoint vote(option : int) =\n    require(!is_closed(), "POLL_ALREADY_CLOSED")\n    require(Map.member(option, state.vote_options), "VOTE_OPTION_NOT_KNOWN")\n    put(state{ votes[Call.caller] = option})\n    Chain.event(Vote(Contract.address, Call.caller, option))\n\n  stateful entrypoint revoke_vote() =\n    put(state{ votes = Map.delete(Call.caller, state.votes) })\n    Chain.event(RevokeVote(Contract.address, Call.caller))\n\n  // STATELESS PUBLIC FUNCTIONS\n\n  entrypoint get_state() : state = state\n\n  entrypoint title() : string = state.metadata.title\n\n  entrypoint close_height() : option(int) = state.close_height\n\n  entrypoint metadata() : metadata = state.metadata\n\n  entrypoint votes() : votes = state.votes\n\n  entrypoint is_author(author : address) : bool = state.author == author\n\n  entrypoint has_voted(voter : address) : bool = Map.member(voter, state.votes)\n\n  entrypoint is_closed() : bool =\n    switch(state.close_height)\n      Some(close_height) => Chain.block_height >= close_height\n      None => false\n\n  entrypoint voted_option(voter : address) : option(int) = Map.lookup(voter, state.votes)\n\n  entrypoint version() : int = 2\n',O=i(58572),N=i(94848),A=i(86158);const B={class:"text-gray-500 px-6 py-4"};function $(t,e,i,n,o,a){return(0,r.wg)(),(0,r.iD)("div",B,[(0,r.WI)(t.$slots,"default")])}var R={name:"GrayText"},L=i(83744);const U=(0,L.Z)(R,[["render",$]]);var M=U,V=i(70762),W=i(80054),P=i(11758),F=i(81251),Z=i(7319),j=i(78015);function q(t,e,i,n,a,s){return(0,r.wg)(),(0,r.iD)("div",{class:(0,o.C_)(["ae-button-group",{shadow:i.shadow}])},[(0,r.WI)(t.$slots,"default",{},void 0,!0)],2)}var G={name:"ae-button-group",props:{shadow:Boolean}};const Y=(0,L.Z)(G,[["render",q],["__scopeId","data-v-bf7826b4"]]);var z=Y,K=i(25108),Q={name:"CreatePage",components:{CriticalErrorOverlay:V.Z,HintBubble:P.Z,GrayText:M,BlackHeader:A.Z,BottomButtons:N.Z,AeButton:j.Z,AeInput:W.Z,BiggerLoader:O.Z,AeButtonGroup:z},data(){return{showLoading:!1,showForumHint:!1,createMetadata:{title:"",description:"",link:"",spec_ref:void 0},is_listed:!0,optionsString:"",closeHeight:0,polls:[],options:[{id:0,text:""}],nextId:1,height:0,heightTimestamp:0,dateString:"",timeString:"",criticalError:null,errors:{titleError:null,descriptionError:null,linkError:null,optionError:null,closeHeightError:null}}},computed:{closeDate(){return this.closeHeight-this.height>0?new Date(Date.now()+3*(this.closeHeight-this.height)*60*1e3):null}},methods:{linkBlurHandler(){this.showForumHint=!!this.createMetadata.link&&-1===this.createMetadata.link.indexOf("forum.aeternity.com")},leftPad(t){return String("0"+t).slice(-2)},updateCloseHeight(){const t=Math.round((new Date(`${this.dateString} ${this.timeString}`).getTime()-this.heightTimestamp)/1e3/60/3)+this.height;this.closeHeight=t<0?0:t},updateDateInputs(){this.closeDate?(this.dateString=`${this.closeDate.getFullYear()}-${this.leftPad(this.closeDate.getMonth()+1)}-${this.leftPad(this.closeDate.getDate())}`,this.timeString=`${this.leftPad(this.closeDate.getHours())}:${this.leftPad(this.closeDate.getMinutes())}`):(this.dateString="",this.timeString="")},async createPoll(){this.errors={titleError:null,descriptionError:null,linkError:null,optionError:null,closeHeightError:null},this.createMetadata.title=this.createMetadata.title.trim(),0===this.createMetadata.title.length&&(this.errors.titleError="Please provide a title."),this.createMetadata.title.length>50&&(this.errors.titleError="Your title is too long (50 chars max)."),this.createMetadata.description=this.createMetadata.description.trim(),0===this.createMetadata.description.length&&(this.errors.descriptionError="Please provide a description."),this.createMetadata.link=this.createMetadata.link.trim(),-1===this.createMetadata.link.indexOf("http")&&(this.errors.linkError="Your link must include http:// or https://."),0===this.createMetadata.link.length&&(this.errors.linkError="Please provide a link.");let t=this.options.filter((t=>!!t.text.trim()));if(t.length<2&&(this.errors.optionError="Please provide at least two options."),0===this.closeHeight.length?this.errors.closeHeightError="Please provide a closing height.":isNaN(parseInt(this.closeHeight))?this.errors.closeHeightError="The closing height is not a whole number.":parseInt(this.closeHeight)<=this.height&&"0"!==this.closeHeight&&(this.errors.closeHeightError="The closing height lies in the past."),Object.values(this.errors).some((t=>!!t)))return document.querySelector(".wrapper").scrollTo(0,0);if(this.createMetadata.title.length>=3&&this.options.length>=3){this.showLoading=!0;const i=0===parseInt(this.closeHeight)?void 0:parseInt(this.closeHeight);let r=0;t=this.options.filter((t=>!!t.text)).map((t=>(t.id=r++,t))).reduce(((t,e)=>Object.assign(t,{[e.id]:e.text})),{});try{const e=D,r=await F.SZ.getContractInstance({source:e}),n=await r.methods.init(this.createMetadata,t,i,{omitUnknown:!0}),o=await Z.Z.registry.methods.add_poll(n.address,this.is_listed,{omitUnknown:!0});this.$router.push(`/poll/${o.decodedResult}`)}catch(e){this.showLoading=!1,this.criticalError="Could not create your poll. Please try again.","string"===typeof e&&(this.criticalError+=` Error: ${e}`),K.error(e)}}},optionInput(){if(this.options[this.options.length-1].text){const t=++this.nextId;this.options.push({id:t,text:""})}this.options.length>1&&!this.options[this.options.length-2].text&&this.options.pop()},removeOption(t){this.options=this.options.filter((e=>e.id!==t))}},async created(){this.height=await F.SZ.getHeight(),this.heightTimestamp=Date.now(),this.closeHeight=14400+this.height,this.updateDateInputs()}};const J=(0,L.Z)(Q,[["render",H],["__scopeId","data-v-2b2e2128"]]);var X=J}}]);
//# sourceMappingURL=create.ec473b87.js.map